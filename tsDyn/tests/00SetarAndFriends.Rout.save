
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R est un logiciel libre livré sans AUCUNE GARANTIE.
Vous pouvez le redistribuer sous certaines conditions.
Tapez 'license()' ou 'licence()' pour plus de détails.

R est un projet collaboratif avec de nombreux contributeurs.
Tapez 'contributors()' pour plus d'information et
'citation()' pour la façon de le citer dans les publications.

Tapez 'demo()' pour des démonstrations, 'help()' pour l'aide
en ligne ou 'help.start()' pour obtenir l'aide au format HTML.
Tapez 'q()' pour quitter R.

REvolution R enhancements not installed.  For improved
performance and other extensions: apt-get install revolution-r

> library(tsDyn)
Loading required package: mgcv
This is mgcv 1.6-2. For overview type 'help("mgcv-package")'.
Loading required package: Matrix
Loading required package: lattice

Attaching package: 'Matrix'

The following object(s) are masked from 'package:base':

    det

Loading required package: snow
Loading required package: mnormt
Loading required package: foreach
Loading required package: iterators
Loading required package: codetools
Loading required package: MASS
> 
> data(zeroyld)
> dat<-zeroyld
> 
> ###SETAR
> 
> mod.setar <- setar(log10(lynx), m=2, thDelay=1, th=3.25)
Warning message:
Possible unit root in the high  regime. Roots are: 0.8985 0.8985 
> mod.setar

Non linear autoregressive model

SETAR model ( 2 regimes)
Coefficients:
Low regime:
    phiL.1     phiL.2    const L 
 1.2538064 -0.4184042  0.5908673 

High regime:
   phiH.1    phiH.2   const H 
 1.526853 -1.238662  2.232671 

Threshold:
-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)
-Value: 3.25 (fixed)
Proportion of points in low regime: 66.96% 	 High regime: 33.04% 
> summary(mod.setar)

Non linear autoregressive model

SETAR model ( 2 regimes)
Coefficients:
Low regime:
    phiL.1     phiL.2    const L 
 1.2538064 -0.4184042  0.5908673 

High regime:
   phiH.1    phiH.2   const H 
 1.526853 -1.238662  2.232671 

Threshold:
-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)
-Value: 3.25 (fixed)
Proportion of points in low regime: 66.96% 	 High regime: 33.04% 

Residuals:
       Min         1Q     Median         3Q        Max 
-0.5769141 -0.1198456  0.0034299  0.1191886  0.5173509 

Fit:
residuals variance = 0.04053,  AIC = -353, MAPE = 5.76%

Coefficient(s):

         Estimate  Std. Error  t value  Pr(>|t|)    
const L  0.590867    0.152011   3.8870 0.0001755 ***
phiL.1   1.253806    0.071265  17.5936 < 2.2e-16 ***
phiL.2  -0.418404    0.087630  -4.7746 5.690e-06 ***
const H  2.232671    0.801695   2.7849 0.0063238 ** 
phiH.1   1.526853    0.103082  14.8121 < 2.2e-16 ***
phiH.2  -1.238662    0.255539  -4.8473 4.219e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Threshold
Variable: Z(t) = + (0) X(t) + (1) X(t-1)

Value: 3.25 (fixed)
> 
> setar(lynx,m=2, th=1426,trace=TRUE,thDelay=1)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 

Non linear autoregressive model

SETAR model ( 2 regimes)
Coefficients:
Low regime:
     phiL.1      phiL.2     const L 
  1.5434194  -0.4291513 315.6983921 

High regime:
      phiH.1       phiH.2      const H 
   0.9830795   -0.6362265 1292.8489487 

Threshold:
-Variable: Z(t) = + (0) X(t)+ (1)X(t-1)
-Value: 1426 (fixed)
Proportion of points in low regime: 60.71% 	 High regime: 39.29% 
Warning message:
Possible unit root in the low  regime. Roots are: 0.8477 2.7487 
> setar(lynx,m=2, th=c(600,1426),trace=TRUE)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using maximum autoregressive order for middle regime: mM = 2 

Non linear autoregressive model

SETAR model ( 3 regimes)
Coefficients:
Low regime:
    phiL.1     phiL.2    const L 
 2.1592162 -0.3612925 37.7065835 

Mid regime:
    phiM.1     phiM.2    const M 
 2.2239335 -0.5028274 55.9687980 

High regime:
     phiH.1      phiH.2     const H 
   1.030366   -0.737548 1507.797242 

Threshold:
-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (1)X(t-0)
-Value:  600 1426 (fixed)
Proportion of points in low regime: 42.86% 	 Middle regime: 16.96% 	 High regime: 40.18% 
Warning messages:
1: Possible unit root in the low  regime. Roots are: 0.506 5.4704 
2: Possible unit root in the medium  regime. Roots are: 0.508 3.9149 
> setar(lynx,m=2, trace=TRUE,nthresh=1)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching on 74 possible threshold values within regimes with sufficient ( 15% ) number of observations
Searching on 74 combinations of thresholds (74) and thDelay (1) 
Selected threshold:  1388 
Selected delay:  0 

Non linear autoregressive model

SETAR model ( 2 regimes)
Coefficients:
Low regime:
    phiL.1     phiL.2    const L 
 2.3330905 -0.4206083 -2.4440208 

High regime:
     phiH.1      phiH.2     const H 
   1.044104   -0.741993 1465.133661 

Threshold:
-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)
-Value: 1388
Proportion of points in low regime: 58.93% 	 High regime: 41.07% 
Warning message:
Possible unit root in the low  regime. Roots are: 0.4681 5.0788 
> setar(lynx,m=2, trace=TRUE,nthresh=2, trim=0.05)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using maximum autoregressive order for middle regime: mM = 2 
Searching on 96 possible threshold values within regimes with sufficient ( 5% ) number of observations
Searching on 96 combinations of thresholds (96) and thDelay (1) 
Result of the one threshold search:
 -Thresh:  1388 	-Delay:  0 	- SSR 67408458 
Second best: 3465 (conditionnal on th= 1388 and Delay= 0 ) 	 SSR/AIC: 53987715
Second best: 1388 (conditionnal on th= 3465 and Delay= 0 ) 	 SSR/AIC: 53987715
Selected threshold:  1388 3465 
Selected delay:  0 

Non linear autoregressive model

SETAR model ( 3 regimes)
Coefficients:
Low regime:
    phiL.1     phiL.2    const L 
 2.3330905 -0.4206083 -2.4440208 

Mid regime:
   phiM.1    phiM.2   const M 
 1.878627 -0.942074 48.082499 

High regime:
     phiH.1      phiH.2     const H 
  1.0524925  -0.4482403 -60.0542362 

Threshold:
-Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (1)X(t-0)
-Value: 1388 3465
Proportion of points in low regime: 58.93% 	 Middle regime: 28.57% 	 High regime: 12.5% 
Warning message:
Possible unit root in the low  regime. Roots are: 0.4681 5.0788 
> a<-setar(lynx,m=2)
Warning message:
Possible unit root in the low  regime. Roots are: 0.4681 5.0788 
> deviance(a)
         [,1]
[1,] 67408458
> 
> ###SelectSetar
> selectSETAR(lynx, m=2, d=1,  trace=TRUE, include = "const", common="none", model="TAR", nthresh=1,trim=0.15,criterion = "SSR",thSteps = 7,  plot=FALSE,max.iter=2)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching on 74 possible threshold values within regimes with sufficient ( 15% ) number of observations
Searching on 74 combinations of thresholds (74) and thDelay (1) 
Results of the grid search for 1 threshold
	 Conditional on m=  2 
   thDelay   th      SSR
1        0 1388 67408458
2        0 1307 67518614
3        0  871 67933996
4        0 1000 67974066
5        0 1033 68019679
6        0 1132 68097638
7        0 1292 68230420
8        0  808 68250304
9        0  957 68288887
10       0  784 68734556
> selectSETAR(lynx, m=2, d=1,  trace=TRUE, include = "const", common="none", model="TAR", nthresh=2,trim=0.15,criterion = "SSR",thSteps = 7,  plot=FALSE,max.iter=3)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using maximum autoregressive order for middle regime: mM = 2 
Searching on 74 possible threshold values within regimes with sufficient ( 15% ) number of observations
Searching on 74 combinations of thresholds (74) and thDelay (1) 
Result of the one threshold search:
 -Thresh:  1388 	-Delay:  0 	- SSR 67408458 
Second best: 2536 (conditionnal on th= 1388 and Delay= 0 ) 	 SSR/AIC: 60665581
Second best: 1132 (conditionnal on th= 2536 and Delay= 0 ) 	 SSR/AIC: 59831519
Second best: 2536 (conditionnal on th= 1132 and Delay= 0 ) 	 SSR/AIC: 59831519
Results of the grid search for 1 threshold
	 Conditional on m=  2 
  thDelay   th      SSR
1       0 1388 67408458
2       0 1307 67518614
3       0  871 67933996
4       0 1000 67974066
5       0 1033 68019679

Results of the grid search for 2 thresholds
 	 Conditional on thDelay =  0  and m = 2 
   th1  th2      SSR
1 1132 2536 59831519

Overall best results:
 thDelay      th1      th2      SSR 
       0     1132     2536 59831519 
With lags:
	-ML: 1 2 
	-MM: 1 2 
	-MH: 1 2 
> selectSETAR(lynx, m=2, d=1, th=MakeThSpec(ngrid="Half"), common="none",trim=0.15,criterion = "SSR", plot=FALSE)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching on 39 possible threshold values within regimes with sufficient ( 15% ) number of observations
Searching on 39 combinations of thresholds (39) and thDelay (1) 
Results of the grid search for 1 threshold
	 Conditional on m=  2 
   thDelay   th      SSR
1        0 1388 67408458
2        0 1033 68019679
3        0 1292 68230420
4        0  808 68250304
5        0  957 68288887
6        0  758 68951854
7        0  731 69101879
8        0 1475 69183671
9        0  684 70591358
10       0  662 70956483
> selectSETAR(lynx, m=2, d=1, th=MakeThSpec(ngrid=20), common="none",trim=0.15,criterion = "SSR", plot=FALSE)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching on 20 possible threshold values within regimes with sufficient ( 15% ) number of observations
Searching on 20 combinations of thresholds (20) and thDelay (1) 
Results of the grid search for 1 threshold
	 Conditional on m=  2 
   thDelay   th      SSR
1        0 1388 67408458
2        0 1033 68019679
3        0  808 68250304
4        0  731 69101879
5        0  662 70956483
6        0 1590 71081206
7        0 1676 71697226
8        0  546 72271914
9        0  473 73478005
10       0  399 73865774
> selectSETAR(lynx, m=2, d=1, th=MakeThSpec(exact=1388), common="none",trim=0.15,criterion = "SSR", plot=FALSE)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching on 1 combinations of thresholds (1) and thDelay (1) 
Results of the grid search for 1 threshold
	 Conditional on m=  2 
  thDelay   th      SSR
1       0 1388 67408458
> selectSETAR(lynx, m=2, d=1, th=MakeThSpec(around=1388, ngrid=20), common="none",criterion = "SSR", plot=FALSE)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching within 20 values around 1388 
Searching on 21 combinations of thresholds (21) and thDelay (1) 
Results of the grid search for 1 threshold
	 Conditional on m=  2 
   thDelay   th      SSR
1        0 1388 67408458
2        0 1307 67518614
3        0  871 67933996
4        0 1000 67974066
5        0 1033 68019679
6        0 1132 68097638
7        0 1292 68230420
8        0  808 68250304
9        0  957 68288887
10       0  784 68734556
> selectSETAR(lynx, m=2, d=1, th=MakeThSpec(int=c(957, 1824)), common="none",criterion = "SSR", plot=FALSE)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching within 15 values between 957 and 1824 
Searching on 15 combinations of thresholds (15) and thDelay (1) 
Results of the grid search for 1 threshold
	 Conditional on m=  2 
   thDelay   th      SSR
1        0 1388 67408458
2        0 1307 67518614
3        0 1000 67974066
4        0 1033 68019679
5        0 1132 68097638
6        0 1292 68230420
7        0  957 68288887
8        0 1475 69183671
9        0 1426 69383627
10       0 1590 71081206
> selectSETAR(lynx, m=2, d=1, th=MakeThSpec(int=c(957, 1824), ngrid=5), common="none",criterion = "SSR", plot=FALSE)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching within 5 values between 957 and 1824 
Searching on 5 combinations of thresholds (5) and thDelay (1) 
Results of the grid search for 1 threshold
	 Conditional on m=  2 
  thDelay   th      SSR
1       0 1132 68097638
2       0  957 68288887
3       0 1426 69383627
4       0 1594 71748426
5       0 1824 73711421
> selectSETAR(lynx, m=2, d=1, th=MakeThSpec(int=c(957, 1824), ngrid="Half"), common="none",criterion = "SSR", plot=FALSE)
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Searching within 7.5 values between 957 and 1824 
Searching on 8 combinations of thresholds (8) and thDelay (1) 
Results of the grid search for 1 threshold
	 Conditional on m=  2 
  thDelay   th      SSR
1       0 1388 67408458
2       0 1033 68019679
3       0 1292 68230420
4       0  957 68288887
5       0 1475 69183671
6       0 1590 71081206
7       0 1623 71572143
8       0 1824 73711421
> 
> 
> ###TVAR
> tvar<-TVAR(dat[1:100,], lag=2, nthresh=2,thDelay=1,trim=0.1, plot=FALSE, include="const")
Best unique threshold 3.173 
Second best: 2.987 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 5.513542
Second best: 3.173 (conditionnal on th= 2.987 and Delay= 1 ) 	 SSR/AIC: 5.513542

Second step best thresholds 3.091 3.405 		 SSR: 5.359576 
> class(tvar)
[1] "TVAR"  "nlVar"
> tvar
Model TVAR with  2  thresholds

$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579


Threshold value[1] "3.091 3.405"
> print(tvar)
Model TVAR with  2  thresholds

$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579


Threshold value[1] "3.091 3.405"
> coefficients(tvar)
$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579

> ##FIXME
> summary(tvar)$VAR
NULL
> ##FIXME
> tvar$VAR
NULL
> 
> coefficients(summary(tvar))
$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579

> logLik(tvar)
[1] -7.662705
> AIC(tvar)
[1] -686.9451
> BIC(tvar)
[1] -604.2262
> coef(tvar)
$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579

> deviance(tvar)
[1] 5.359576
> head(residuals(tvar))
     short.run    long.run
3 -0.004597009  0.13556926
4  0.042833906 -0.09146197
5  0.098364773 -0.05242712
6 -0.098242642 -0.11095025
7 -0.141652551 -0.10341638
8 -0.084140183  0.01981197
> tail(residuals(tvar))
     short.run    long.run
95  -0.1326403  0.09671450
96   0.1258271 -0.28920157
97   0.1782376  0.04344887
98  -0.1549201 -0.08167471
99   0.0976071  0.15553665
100  0.3188607  0.01232640
> head(fitted(tvar))
              [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]
short.run 2.312597 2.358166 2.459635 2.605243 2.537653 2.436140 2.398192
long.run  1.626431 1.864462 1.860427 1.920950 1.806416 1.663188 1.695070
              [,8]     [,9]    [,10]    [,11]    [,12]    [,13]    [,14]
short.run 2.478002 2.554350 2.572885 2.565622 2.535818 2.673237 2.545264
long.run  1.910968 1.892863 1.814408 1.984992 1.771023 1.950114 1.719283
             [,15]    [,16]    [,17]    [,18]    [,19]    [,20]    [,21]
short.run 2.467296 2.437495 2.476144 2.525321 2.608905 2.747267 2.566627
long.run  1.799972 1.904817 2.003025 2.073416 2.160169 2.122039 1.930599
             [,22]    [,23]    [,24]    [,25]    [,26]    [,27]    [,28]
short.run 2.559613 2.607790 2.705683 2.757892 2.789695 3.014279 3.347845
long.run  2.157246 2.202943 2.148279 2.271658 2.138166 2.610606 2.818538
             [,29]    [,30]    [,31]    [,32]    [,33]    [,34]    [,35]
short.run 2.993931 2.990744 3.094881 2.639861 2.739699 2.759178 2.490336
long.run  2.107185 2.271194 2.225796 1.677351 1.708716 1.793964 1.531457
             [,36]    [,37]    [,38]    [,39]    [,40]     [,41]     [,42]
short.run 2.537768 2.481791 2.432363 2.362700 2.533373 2.4326546 2.3917424
long.run  1.174975 1.135244 1.153203 0.972194 1.085569 0.8325739 0.9257494
             [,43]    [,44]    [,45]    [,46]    [,47]    [,48]    [,49]
short.run 2.465162 2.465612 2.453085 2.515958 2.517572 2.659377 2.707126
long.run  1.133051 1.253524 1.294242 1.315215 1.327843 1.595040 1.905389
             [,50]    [,51]    [,52]    [,53]    [,54]    [,55]    [,56]
short.run 2.713997 2.770904 2.745888 2.867980 2.981468 2.946249 2.901760
long.run  1.772854 2.012037 1.846154 2.036321 2.271556 2.404872 2.210197
             [,57]    [,58]    [,59]    [,60]    [,61]    [,62]    [,63]
short.run 2.815779 2.904073 2.950449 2.851557 2.863250 3.097461 3.058475
long.run  2.263140 2.764392 2.732322 2.343748 2.558505 2.852196 3.030444
             [,64]    [,65]    [,66]    [,67]    [,68]    [,69]    [,70]
short.run 2.923493 3.009512 3.450304 3.360482 3.413217 3.558196 3.603286
long.run  2.727105 2.689456 3.342573 3.210796 3.445959 3.494754 3.705233
             [,71]    [,72]    [,73]    [,74]    [,75]    [,76]    [,77]
short.run 3.644035 3.310912 3.322452 3.201886 3.586685 3.683194 3.801858
long.run  3.762450 3.224052 3.308528 2.932396 3.547233 3.565510 3.685205
             [,78]    [,79]    [,80]    [,81]    [,82]    [,83]    [,84]
short.run 3.830986 3.780125 3.791722 3.811700 3.257734 3.091832 3.049026
long.run  3.707195 3.905426 3.958730 3.817703 3.149080 2.498136 1.835789
             [,85]    [,86]    [,87]    [,88]    [,89]    [,90]    [,91]
short.run 3.038709 2.890780 2.822684 2.908177 2.981796 3.634141 3.888641
long.run  1.679343 1.553736 1.396517 1.350065 1.343899 2.767290 3.306703
             [,92]    [,93]    [,94]    [,95]    [,96]    [,97]    [,98]
short.run 3.847545 3.776640 3.775173 3.812762 3.950920 3.875393 3.883139
long.run  3.463008 3.284285 3.479202 3.359551 3.464675 3.438463 3.595674
> tail(fitted(tvar))
              [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]
short.run 2.312597 2.358166 2.459635 2.605243 2.537653 2.436140 2.398192
long.run  1.626431 1.864462 1.860427 1.920950 1.806416 1.663188 1.695070
              [,8]     [,9]    [,10]    [,11]    [,12]    [,13]    [,14]
short.run 2.478002 2.554350 2.572885 2.565622 2.535818 2.673237 2.545264
long.run  1.910968 1.892863 1.814408 1.984992 1.771023 1.950114 1.719283
             [,15]    [,16]    [,17]    [,18]    [,19]    [,20]    [,21]
short.run 2.467296 2.437495 2.476144 2.525321 2.608905 2.747267 2.566627
long.run  1.799972 1.904817 2.003025 2.073416 2.160169 2.122039 1.930599
             [,22]    [,23]    [,24]    [,25]    [,26]    [,27]    [,28]
short.run 2.559613 2.607790 2.705683 2.757892 2.789695 3.014279 3.347845
long.run  2.157246 2.202943 2.148279 2.271658 2.138166 2.610606 2.818538
             [,29]    [,30]    [,31]    [,32]    [,33]    [,34]    [,35]
short.run 2.993931 2.990744 3.094881 2.639861 2.739699 2.759178 2.490336
long.run  2.107185 2.271194 2.225796 1.677351 1.708716 1.793964 1.531457
             [,36]    [,37]    [,38]    [,39]    [,40]     [,41]     [,42]
short.run 2.537768 2.481791 2.432363 2.362700 2.533373 2.4326546 2.3917424
long.run  1.174975 1.135244 1.153203 0.972194 1.085569 0.8325739 0.9257494
             [,43]    [,44]    [,45]    [,46]    [,47]    [,48]    [,49]
short.run 2.465162 2.465612 2.453085 2.515958 2.517572 2.659377 2.707126
long.run  1.133051 1.253524 1.294242 1.315215 1.327843 1.595040 1.905389
             [,50]    [,51]    [,52]    [,53]    [,54]    [,55]    [,56]
short.run 2.713997 2.770904 2.745888 2.867980 2.981468 2.946249 2.901760
long.run  1.772854 2.012037 1.846154 2.036321 2.271556 2.404872 2.210197
             [,57]    [,58]    [,59]    [,60]    [,61]    [,62]    [,63]
short.run 2.815779 2.904073 2.950449 2.851557 2.863250 3.097461 3.058475
long.run  2.263140 2.764392 2.732322 2.343748 2.558505 2.852196 3.030444
             [,64]    [,65]    [,66]    [,67]    [,68]    [,69]    [,70]
short.run 2.923493 3.009512 3.450304 3.360482 3.413217 3.558196 3.603286
long.run  2.727105 2.689456 3.342573 3.210796 3.445959 3.494754 3.705233
             [,71]    [,72]    [,73]    [,74]    [,75]    [,76]    [,77]
short.run 3.644035 3.310912 3.322452 3.201886 3.586685 3.683194 3.801858
long.run  3.762450 3.224052 3.308528 2.932396 3.547233 3.565510 3.685205
             [,78]    [,79]    [,80]    [,81]    [,82]    [,83]    [,84]
short.run 3.830986 3.780125 3.791722 3.811700 3.257734 3.091832 3.049026
long.run  3.707195 3.905426 3.958730 3.817703 3.149080 2.498136 1.835789
             [,85]    [,86]    [,87]    [,88]    [,89]    [,90]    [,91]
short.run 3.038709 2.890780 2.822684 2.908177 2.981796 3.634141 3.888641
long.run  1.679343 1.553736 1.396517 1.350065 1.343899 2.767290 3.306703
             [,92]    [,93]    [,94]    [,95]    [,96]    [,97]    [,98]
short.run 3.847545 3.776640 3.775173 3.812762 3.950920 3.875393 3.883139
long.run  3.463008 3.284285 3.479202 3.359551 3.464675 3.438463 3.595674
> 
> 
> ##FIXME
> options(show.signif.stars=TRUE)
> summary(tvar)
Model TVAR with  2  thresholds

Full sample size: 100 	End sample size: 98
Number of variables: 2 	Number of estimated parameters: 30 + 2
AIC -686.9451 	BIC -604.2262 	 SSR 5.359576 

[[1]]
                   Intercept       short.run -1      long.run -1      
Equation short.run 0.2588(0.2400)  1.0010(0.2014)*** -0.0303(0.1269)  
Equation long.run  0.2538(0.3101)  0.4796(0.2602).   1.1062(0.1639)***
                   short.run -2     long.run -2     
Equation short.run -0.1216(0.1949)  0.0749(0.1318)  
Equation long.run  -0.5611(0.2518)* -0.1199(0.1702) 

[[2]]
                   Intercept       short.run -1     long.run -1      
Equation short.run 5.1844(2.7743). -1.0350(0.9501)  0.5344(0.2556)*  
Equation long.run  7.3273(3.5840)* -3.0715(1.2273)* 1.9818(0.3301)***
                   short.run -2      long.run -2       
Equation short.run 0.6156(0.3134).   -0.6790(0.2424)** 
Equation long.run  1.4852(0.4049)*** -1.6386(0.3132)***

[[3]]
                   Intercept       short.run -1     long.run -1     
Equation short.run 1.7057(0.8701). 0.3792(0.3217)   -0.0089(0.1811) 
Equation long.run  1.8901(1.1240). -0.0081(0.4156)  0.6335(0.2339)**
                   short.run -2     long.run -2     
Equation short.run 0.3090(0.2665)   -0.1389(0.1220) 
Equation long.run  -0.1263(0.3443)  -0.0176(0.1576) 

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Threshold value: 3.091 3.405
Percentage of Observations in each regime: 71.4% 10.2% 18.4%> 
> options(show.signif.stars=FALSE)
> summary(tvar)
Model TVAR with  2  thresholds

Full sample size: 100 	End sample size: 98
Number of variables: 2 	Number of estimated parameters: 30 + 2
AIC -686.9451 	BIC -604.2262 	 SSR 5.359576 

[[1]]
                   Intercept      short.run -1   long.run -1    
Equation short.run 0.2588(0.2400) 1.0010(0.2014) -0.0303(0.1269)
Equation long.run  0.2538(0.3101) 0.4796(0.2602) 1.1062(0.1639) 
                   short.run -2    long.run -2    
Equation short.run -0.1216(0.1949) 0.0749(0.1318) 
Equation long.run  -0.5611(0.2518) -0.1199(0.1702)

[[2]]
                   Intercept      short.run -1    long.run -1    short.run -2  
Equation short.run 5.1844(2.7743) -1.0350(0.9501) 0.5344(0.2556) 0.6156(0.3134)
Equation long.run  7.3273(3.5840) -3.0715(1.2273) 1.9818(0.3301) 1.4852(0.4049)
                   long.run -2    
Equation short.run -0.6790(0.2424)
Equation long.run  -1.6386(0.3132)

[[3]]
                   Intercept      short.run -1    long.run -1    
Equation short.run 1.7057(0.8701) 0.3792(0.3217)  -0.0089(0.1811)
Equation long.run  1.8901(1.1240) -0.0081(0.4156) 0.6335(0.2339) 
                   short.run -2    long.run -2    
Equation short.run 0.3090(0.2665)  -0.1389(0.1220)
Equation long.run  -0.1263(0.3443) -0.0176(0.1576)


Threshold value: 3.091 3.405
Percentage of Observations in each regime: 71.4% 10.2% 18.4%> 
> print(summary(tvar), digits=3)
Model TVAR with  2  thresholds

Full sample size: 100 	End sample size: 98
Number of variables: 2 	Number of estimated parameters: 30 + 2
AIC -686.9451 	BIC -604.2262 	 SSR 5.359576 

[[1]]
                   Intercept    short.run -1 long.run -1   short.run -2 
Equation short.run 0.259(0.240) 1.001(0.201) -0.030(0.127) -0.122(0.195)
Equation long.run  0.254(0.310) 0.480(0.260) 1.106(0.164)  -0.561(0.252)
                   long.run -2  
Equation short.run 0.075(0.132) 
Equation long.run  -0.120(0.170)

[[2]]
                   Intercept    short.run -1  long.run -1  short.run -2
Equation short.run 5.184(2.774) -1.035(0.950) 0.534(0.256) 0.616(0.313)
Equation long.run  7.327(3.584) -3.071(1.227) 1.982(0.330) 1.485(0.405)
                   long.run -2  
Equation short.run -0.679(0.242)
Equation long.run  -1.639(0.313)

[[3]]
                   Intercept    short.run -1  long.run -1   short.run -2 
Equation short.run 1.706(0.870) 0.379(0.322)  -0.009(0.181) 0.309(0.267) 
Equation long.run  1.890(1.124) -0.008(0.416) 0.634(0.234)  -0.126(0.344)
                   long.run -2  
Equation short.run -0.139(0.122)
Equation long.run  -0.018(0.158)


Threshold value: 3.091 3.405
Percentage of Observations in each regime: 71.4% 10.2% 18.4%> 
> toLatex(tvar)
%insert in the preamble and uncomment the line you want for usual /medium /small matrix
%\usepackage{amsmath} \newenvironment{smatrix}{\begin{pmatrix}}{\end{pmatrix}} %USUAL
%\usepackage{amsmath} \newenvironment{smatrix}{\left(\begin{smallmatrix}}{\end{smallmatrix}\right)} %SMALL
%\usepackage{nccmath} \newenvironment{smatrix}{\left(\begin{mmatrix}}{\end{mmatrix}\right)} %MEDIUM
\begin{equation}
\begin{smatrix} %explained vector
X_{t}^{1} \\ X_{t}^{2}
\end{smatrix}=
\left\{
\begin{array}{ll}
\begin{smatrix}     %const
0.2588 \\ 0.2538
\end{smatrix}
+\begin{smatrix}      %Lag1
1.0010 & -0.0303 \\
0.4796 & 1.1062 
\end{smatrix}
\begin{smatrix}
X_{t-1}^{1} \\ X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
-0.1216 & 0.0749 \\
-0.5611 & -0.1199 
\end{smatrix}
\begin{smatrix}
X_{t-2}^{1} \\ X_{t-2}^{2}
\end{smatrix}
& \text{if Th}< 3.091 \\
\begin{smatrix}     %const
5.1844 \\ 7.3273
\end{smatrix}
+\begin{smatrix}      %Lag1
-1.0350 & 0.5344 \\
-3.0715 & 1.9818 
\end{smatrix}
\begin{smatrix}
X_{t-1}^{1} \\ X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
0.6156 & -0.6790 \\
1.4852 & -1.6386 
\end{smatrix}
\begin{smatrix}
X_{t-2}^{1} \\ X_{t-2}^{2}
\end{smatrix}
& \text{if } 3.091 < \text{Th} < 3.405 \\
\begin{smatrix}     %const
1.7057 \\ 1.8901
\end{smatrix}
+\begin{smatrix}      %Lag1
0.3792 & -0.0089 \\
-0.0081 & 0.6335 
\end{smatrix}
\begin{smatrix}
X_{t-1}^{1} \\ X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
0.3090 & -0.1389 \\
-0.1263 & -0.0176 
\end{smatrix}
\begin{smatrix}
X_{t-2}^{1} \\ X_{t-2}^{2}
\end{smatrix}
& \text{if Th}> 3.405 \\
\end{array}
\right.
\end{equation}
> 
> if(0) {##FIXME
+ toLatex(summary(tvar), digits=2)
+ tvar$coefficients
+ tvar$StDev
+ options(show.signif.stars=FALSE)
+ toLatex(summary(tvar), digits=2)
+ }
> 
> ###TVECM
> tvecm<-TVECM(dat, nthresh=2,lag=1, ngridBeta=20, ngridTh=20, plot=FALSE,trim=0.05, common="All")
29 (7.2%) points of the grid lead to regimes with percentage of observations < trim and were not computed
Best threshold from first search -1.195 
Best cointegrating value 1.057203 
There were  2  thresholds values which minimize the SSR in the conditional step, the first one was taken
Second best (conditionnal on the first one) -1.195 0.643 	 SSR 157.1432 
There were  4  thresholds values which minimize the SSR in the iterative step, the first one was taken
Second step best thresholds -1.414 0.643 			 SSR 155.6996 
> class(tvecm)
[1] "TVECM" "nlVar"
> tvecm
Model TVECM with  2  thresholds

$Bdown
                         ECT     Const short.run t -1 long.run t -1
Equation short.run 0.2226023 0.5698814      0.2244073  -0.136190681
Equation long.run  1.0935615 1.9832101      0.8186019  -0.002427001

$Bmiddle
                            ECT        Const short.run t -1 long.run t -1
Equation short.run -0.001818286  0.008678988      0.1112658    0.06567174
Equation long.run   0.021794525 -0.004663874      0.3392230    0.23318881

$Bup
                           ECT       Const short.run t -1 long.run t -1
Equation short.run -0.03654149  0.04545852    -0.10772057    0.04261369
Equation long.run   0.09836556 -0.07041546     0.09321772   -0.03159638


Threshold value[1] -1.414  0.643
> print(tvecm)
Model TVECM with  2  thresholds

$Bdown
                         ECT     Const short.run t -1 long.run t -1
Equation short.run 0.2226023 0.5698814      0.2244073  -0.136190681
Equation long.run  1.0935615 1.9832101      0.8186019  -0.002427001

$Bmiddle
                            ECT        Const short.run t -1 long.run t -1
Equation short.run -0.001818286  0.008678988      0.1112658    0.06567174
Equation long.run   0.021794525 -0.004663874      0.3392230    0.23318881

$Bup
                           ECT       Const short.run t -1 long.run t -1
Equation short.run -0.03654149  0.04545852    -0.10772057    0.04261369
Equation long.run   0.09836556 -0.07041546     0.09321772   -0.03159638


Threshold value[1] -1.414  0.643
> coef(tvecm)
$Bdown
                         ECT     Const short.run t -1 long.run t -1
Equation short.run 0.2226023 0.5698814      0.2244073  -0.136190681
Equation long.run  1.0935615 1.9832101      0.8186019  -0.002427001

$Bmiddle
                            ECT        Const short.run t -1 long.run t -1
Equation short.run -0.001818286  0.008678988      0.1112658    0.06567174
Equation long.run   0.021794525 -0.004663874      0.3392230    0.23318881

$Bup
                           ECT       Const short.run t -1 long.run t -1
Equation short.run -0.03654149  0.04545852    -0.10772057    0.04261369
Equation long.run   0.09836556 -0.07041546     0.09321772   -0.03159638

> logLik(tvecm)
[1] -4.734758
> AIC(tvecm)
[1] -2220.684
> BIC(tvecm)
[1] -2112.165
> deviance(tvecm)
[1] 155.6996
> head(residuals(tvecm))
       short.run     long.run
[1,]  0.04939534  0.193936690
[2,]  0.06398128 -0.065673036
[3,]  0.13820838 -0.005925491
[4,] -0.05741097 -0.004714798
[5,] -0.11305669 -0.098436376
[6,] -0.03221867  0.034288364
> tail(residuals(tvecm))
          short.run    long.run
[475,] -0.010012988 -0.11539500
[476,] -0.163431233 -0.30673361
[477,] -0.344621540 -0.09499266
[478,] -0.178474097 -0.30513365
[479,] -0.052429800 -0.31976134
[480,]  0.006681062 -0.15077932
> head(fitted(tvecm))
        short.run     long.run
[1,]  0.012604660  0.023063310
[2,]  0.029018718  0.076673036
[3,]  0.018791624  0.040925491
[4,]  0.006410973  0.006714798
[5,]  0.002056690 -0.008563624
[6,] -0.011781333 -0.054288364
> tail(fitted(tvecm))
          short.run     long.run
[475,] -0.029987012  0.038394998
[476,]  0.021431233 -0.004266394
[477,]  0.015621540  0.011992660
[478,] -0.034525903 -0.121866354
[479,]  0.018429800  0.008761342
[480,] -0.006681062  0.050779325
> summary(tvecm)
#############
###Model TVECM
#############
Full sample size: 482 	End sample size: 480
Number of variables: 2 	Number of estimated parameters 24
AIC -2220.684 	BIC -2112.165 	SSR 155.6996 


Cointegrating vector: (1, - 1.057203 )$Bdown
                   ECT                Const              short.run t -1  
Equation short.run 0.2226(0.0221)*    0.5699(0.0046)**   0.2244(0.1984)  
Equation long.run  1.0936(1.6e-11)*** 1.9832(2.6e-09)*** 0.8186(0.0042)**
                   long.run t -1   
Equation short.run -0.1362(0.1465) 
Equation long.run  -0.0024(0.9873) 

$Bmiddle
                   ECT              Const            short.run t -1 
Equation short.run -0.0018(0.9620)  0.0087(0.6573)   0.1113(0.3087) 
Equation long.run  0.0218(0.7263)   -0.0047(0.8839)  0.3392(0.0576).
                   long.run t -1  
Equation short.run 0.0657(0.2424) 
Equation long.run  0.2332(0.0112)*

$Bup
                   ECT              Const            short.run t -1  
Equation short.run -0.0365(0.5354)  0.0455(0.5218)   -0.1077(0.2964) 
Equation long.run  0.0984(0.3070)   -0.0704(0.5434)  0.0932(0.5798)  
                   long.run t -1   
Equation short.run 0.0426(0.5534)  
Equation long.run  -0.0316(0.7878) 


Threshold
Values: -1.414 0.643
Percentage of Observations in each regime 6.7% 52.9% 40.4%> 
> toLatex(tvecm)
%insert in the preamble and uncomment the line you want for usual /medium /small matrix
%\usepackage{amsmath} \newenvironment{smatrix}{\begin{pmatrix}}{\end{pmatrix}} %USUAL
%\usepackage{amsmath} \newenvironment{smatrix}{\left(\begin{smallmatrix}}{\end{smallmatrix}\right)} %SMALL
%\usepackage{nccmath} \newenvironment{smatrix}{\left(\begin{mmatrix}}{\end{mmatrix}\right)} %MEDIUM
\begin{equation}
\begin{smatrix} %explained vector
\Delta X_{t}^{1} \\ \Delta X_{t}^{2}
\end{smatrix}=
\left\{
\begin{array}{ll}
\begin{smatrix} %ECT
0.2226 \\ 1.0936
\end{smatrix}ECT_{-1}+
\begin{smatrix}     %const
0.5699 \\ 1.9832
\end{smatrix}
+\begin{smatrix}      %Lag1
0.2244 & -0.1362 \\
0.8186 & -0.0024 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-1}^{1} \\ \Delta X_{t-1}^{2}
\end{smatrix}
& \text{if Th}< -1.414 \\
\begin{smatrix} %ECT
-0.0018 \\ 0.0218
\end{smatrix}ECT_{-1}+
\begin{smatrix}     %const
0.0087 \\ -0.0047
\end{smatrix}
+\begin{smatrix}      %Lag1
0.1113 & 0.0657 \\
0.3392 & 0.2332 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-1}^{1} \\ \Delta X_{t-1}^{2}
\end{smatrix}
& \text{if } -1.414 < \text{Th} < 0.643 \\
\begin{smatrix} %ECT
-0.0365 \\ 0.0984
\end{smatrix}ECT_{-1}+
\begin{smatrix}     %const
0.0455 \\ -0.0704
\end{smatrix}
+\begin{smatrix}      %Lag1
-0.1077 & 0.0426 \\
0.0932 & -0.0316 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-1}^{1} \\ \Delta X_{t-1}^{2}
\end{smatrix}
& \text{if Th}> 0.643 \\
\end{array}
\right.
\end{equation}
> options(show.signif.stars=FALSE)
> toLatex(summary(tvecm))
%insert in the preamble and uncomment the line you want for usual /medium /small matrix
%\usepackage{amsmath} \newenvironment{smatrix}{\begin{pmatrix}}{\end{pmatrix}} %USUAL
%\usepackage{amsmath} \newenvironment{smatrix}{\left(\begin{smallmatrix}}{\end{smallmatrix}\right)} %SMALL
%\usepackage{nccmath} \newenvironment{smatrix}{\left(\begin{mmatrix}}{\end{mmatrix}\right)} %MEDIUM
\begin{equation}
\begin{smatrix} %explained vector
\Delta X_{t}^{1} \\ \Delta X_{t}^{2}
\end{smatrix}=
\left\{
\begin{array}{ll}
\begin{smatrix} %ECT
0.2226(0.0970) \\ 1.0936(0.1583)
\end{smatrix}ECT_{-1}+
\begin{smatrix}     %const
0.5699(0.2001) \\ 1.9832(0.3267)
\end{smatrix}
+\begin{smatrix}      %Lag1
0.2244(0.1742) & -0.1362(0.0936) \\
0.8186(0.2845) & -0.0024(0.1529) 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-1}^{1} \\ \Delta X_{t-1}^{2}
\end{smatrix}
& \text{if Th}< -1.414 \\
\begin{smatrix} %ECT
-0.0018(0.0381) \\ 0.0218(0.0622)
\end{smatrix}ECT_{-1}+
\begin{smatrix}     %const
0.0087(0.0195) \\ -0.0047(0.0319)
\end{smatrix}
+\begin{smatrix}      %Lag1
0.1113(0.1092) & 0.0657(0.0561) \\
0.3392(0.1782) & 0.2332(0.0916) 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-1}^{1} \\ \Delta X_{t-1}^{2}
\end{smatrix}
& \text{if } -1.414 < \text{Th} < 0.643 \\
\begin{smatrix} %ECT
-0.0365(0.0589) \\ 0.0984(0.0962)
\end{smatrix}ECT_{-1}+
\begin{smatrix}     %const
0.0455(0.0709) \\ -0.0704(0.1158)
\end{smatrix}
+\begin{smatrix}      %Lag1
-0.1077(0.1031) & 0.0426(0.0719) \\
0.0932(0.1682) & -0.0316(0.1173) 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-1}^{1} \\ \Delta X_{t-1}^{2}
\end{smatrix}
& \text{if Th}> 0.643 \\
\end{array}
\right.
\end{equation}
> 
> ###Linear
> lin<-lineVar(dat,lag=2)
> class(lin)
[1] "VAR"   "nlVar"
> lin
                    Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.06729104    1.0311341  0.02329517  -0.05255831 -0.00905873
Equation long.run  0.03657482    0.4066159  0.95954683  -0.33196199 -0.04690559
> print(lin)
                    Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.06729104    1.0311341  0.02329517  -0.05255831 -0.00905873
Equation long.run  0.03657482    0.4066159  0.95954683  -0.33196199 -0.04690559
> logLik(lin)
[1] -4.53431
> AIC(lin)
[1] -2156.469
> BIC(lin)
[1] -2145.6
> deviance(lin)
[1] 175.6268
> coef(lin)
                    Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.06729104    1.0311341  0.02329517  -0.05255831 -0.00905873
Equation long.run  0.03657482    0.4066159  0.95954683  -0.33196199 -0.04690559
> summary(lin)
#############
###Model VAR 
#############
Full sample size: 482 	End sample size: 480
Number of variables: 2 	Number of estimated slope parameters 10
AIC -2156.469 	BIC -2145.6 	SSR 175.6268

                   Intercept          short.run -1      long.run -1       
Equation short.run 0.0673(0.0348).    1.0311(0.0695)*** 0.0233(0.0395)    
Equation long.run  0.0366(0.0597)     0.4066(0.1195)*** 0.9595(0.0679)*** 
                   short.run -2        long.run -2        
Equation short.run -0.0526(0.0681)     -0.0091(0.0392)    
Equation long.run  -0.3320(0.1171)**   -0.0469(0.0673)    
> toLatex(lin)
%insert in the preamble and uncomment the line you want for usual /medium /small matrix
%\usepackage{amsmath} \newenvironment{smatrix}{\begin{pmatrix}}{\end{pmatrix}} %USUAL
%\usepackage{amsmath} \newenvironment{smatrix}{\left(\begin{smallmatrix}}{\end{smallmatrix}\right)} %SMALL
%\usepackage{nccmath} \newenvironment{smatrix}{\left(\begin{mmatrix}}{\end{mmatrix}\right)} %MEDIUM
\begin{equation}
\begin{smatrix} %explained vector
X_{t}^{1} \\ X_{t}^{2}
\end{smatrix}=
\begin{smatrix}     %const
0.0673 \\ 0.0366
\end{smatrix}
+\begin{smatrix}      %Lag1
1.0311 & 0.0233 \\
0.4066 & 0.9595 
\end{smatrix}
\begin{smatrix}
X_{t-1}^{1} \\ X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
-0.0526 & -0.0091 \\
-0.3320 & -0.0469 
\end{smatrix}
\begin{smatrix}
X_{t-2}^{1} \\ X_{t-2}^{2}
\end{smatrix}
\end{equation}
> toLatex(summary(lin))
%insert in the preamble and uncomment the line you want for usual /medium /small matrix
%\usepackage{amsmath} \newenvironment{smatrix}{\begin{pmatrix}}{\end{pmatrix}} %USUAL
%\usepackage{amsmath} \newenvironment{smatrix}{\left(\begin{smallmatrix}}{\end{smallmatrix}\right)} %SMALL
%\usepackage{nccmath} \newenvironment{smatrix}{\left(\begin{mmatrix}}{\end{mmatrix}\right)} %MEDIUM
\begin{equation}
\begin{smatrix} %explained vector
X_{t}^{1} \\ X_{t}^{2}
\end{smatrix}=
\begin{smatrix}     %const
0.0673(0.0348) \\ 0.0366(0.0597)
\end{smatrix}
+\begin{smatrix}      %Lag1
1.0311(0.0695) & 0.0233(0.0395) \\
0.4066(0.1195) & 0.9595(0.0679) 
\end{smatrix}
\begin{smatrix}
X_{t-1}^{1} \\ X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
-0.0526(0.0681) & -0.0091(0.0392) \\
-0.3320(0.1171) & -0.0469(0.0673) 
\end{smatrix}
\begin{smatrix}
X_{t-2}^{1} \\ X_{t-2}^{2}
\end{smatrix}
\end{equation}
> 
> linVECM<-lineVar(dat,lag=2, model="VECM")
> class(linVECM)
[1] "VECM"  "VAR"   "nlVar"
> linVECM
                           ECT   Intercept short.run -1 long.run -1
Equation short.run -0.01462511  0.01574772   0.03605199  0.02351545
Equation long.run   0.07510479 -0.01217832   0.30947969  0.06668876
                   short.run -2 long.run -2
Equation short.run  -0.04290810 -0.02323537
Equation long.run   -0.02727195 -0.07024155
> print(linVECM)
                           ECT   Intercept short.run -1 long.run -1
Equation short.run -0.01462511  0.01574772   0.03605199  0.02351545
Equation long.run   0.07510479 -0.01217832   0.30947969  0.06668876
                   short.run -2 long.run -2
Equation short.run  -0.04290810 -0.02323537
Equation long.run   -0.02727195 -0.07024155
> logLik(linVECM)
[1] -4.531391
> AIC(linVECM)
[1] -2144.536
> BIC(linVECM)
[1] -2090.304
> deviance(linVECM)
[1] 175.0327
> coef(linVECM)
                           ECT   Intercept short.run -1 long.run -1
Equation short.run -0.01462511  0.01574772   0.03605199  0.02351545
Equation long.run   0.07510479 -0.01217832   0.30947969  0.06668876
                   short.run -2 long.run -2
Equation short.run  -0.04290810 -0.02323537
Equation long.run   -0.02727195 -0.07024155
> summary(linVECM)
#############
###Model VECM 
#############
Full sample size: 482 	End sample size: 479
Number of variables: 2 	Number of estimated slope parameters 12
AIC -2146.536 	BIC -2133.506 	SSR 175.0327
Cointegrating vector (estimated by OLS):
   short.run  long.run
r1         1 -1.059351


                   ECT                 Intercept           short.run -1      
Equation short.run -0.0146(0.0151)     0.0157(0.0146)      0.0361(0.0687)    
Equation long.run  0.0751(0.0258)**    -0.0122(0.0250)     0.3095(0.1178)**  
                   long.run -1        short.run -2        long.run -2        
Equation short.run 0.0235(0.0399)     -0.0429(0.0692)     -0.0232(0.0392)    
Equation long.run  0.0667(0.0684)     -0.0273(0.1185)     -0.0702(0.0672)    
> toLatex(linVECM)
%insert in the preamble and uncomment the line you want for usual /medium /small matrix
%\usepackage{amsmath} \newenvironment{smatrix}{\begin{pmatrix}}{\end{pmatrix}} %USUAL
%\usepackage{amsmath} \newenvironment{smatrix}{\left(\begin{smallmatrix}}{\end{smallmatrix}\right)} %SMALL
%\usepackage{nccmath} \newenvironment{smatrix}{\left(\begin{mmatrix}}{\end{mmatrix}\right)} %MEDIUM
\begin{equation}
\begin{smatrix} %explained vector
\Delta X_{t}^{1} \\ \Delta X_{t}^{2}
\end{smatrix}=
+\begin{smatrix}  %ECT
-0.0146 \\ 0.0751
\end{smatrix}ECT_{-1}
\begin{smatrix}     %const
0.0157 \\ -0.0122
\end{smatrix}
+\begin{smatrix}      %Lag1
0.0361 & 0.0235 \\
0.3095 & 0.0667 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-1}^{1} \\ \Delta X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
-0.0429 & -0.0232 \\
-0.0273 & -0.0702 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-2}^{1} \\ \Delta X_{t-2}^{2}
\end{smatrix}
\end{equation}
> toLatex(summary(linVECM))
%insert in the preamble and uncomment the line you want for usual /medium /small matrix
%\usepackage{amsmath} \newenvironment{smatrix}{\begin{pmatrix}}{\end{pmatrix}} %USUAL
%\usepackage{amsmath} \newenvironment{smatrix}{\left(\begin{smallmatrix}}{\end{smallmatrix}\right)} %SMALL
%\usepackage{nccmath} \newenvironment{smatrix}{\left(\begin{mmatrix}}{\end{mmatrix}\right)} %MEDIUM
\begin{equation}
\begin{smatrix} %explained vector
\Delta X_{t}^{1} \\ \Delta X_{t}^{2}
\end{smatrix}=
+\begin{smatrix}  %ECT
-0.0146(0.0151) \\ 0.0751(0.0258)
\end{smatrix}ECT_{-1}
\begin{smatrix}     %const
0.0157(0.0146) \\ -0.0122(0.0250)
\end{smatrix}
+\begin{smatrix}      %Lag1
0.0361(0.0687) & 0.0235(0.0399) \\
0.3095(0.1178) & 0.0667(0.0684) 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-1}^{1} \\ \Delta X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
-0.0429(0.0692) & -0.0232(0.0392) \\
-0.0273(0.1185) & -0.0702(0.0672) 
\end{smatrix}
\begin{smatrix}
\Delta X_{t-2}^{1} \\ \Delta X_{t-2}^{2}
\end{smatrix}
\end{equation}
> 
> proc.time()
   user  system elapsed 
  5.240   0.080   5.323 
